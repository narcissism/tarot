<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tarot</title>

<style>
body {
  margin: 0;
  height: 100vh;
  background: #111;
  color: #eee;
  font-family: serif;
  display: flex;
}

#controls {
  width: 220px;
  padding: 20px;
  background: #222;
  border-right: 1px solid #444;
}

button {
  width: 100%;
  margin-bottom: 12px;
  padding: 10px;
  background: #333;
  color: #eee;
  border: 1px solid #555;
  border-radius: 6px;
  cursor: pointer;
}

button:hover { background: #444; }

#fan-container {
  flex: 1;
  position: relative;
  overflow: hidden;
}

/* ===== CARD ===== */

.card {
  position: absolute;
  width: 140px;
  height: 220px;
  perspective: 1000px;
}

.card-inner {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.7s ease;
}

.card.flipped .card-inner {
  transform: rotateY(180deg);
  pointer-events: none;
}

.face {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  background-size: cover;
  background-position: center;
  border-radius: 10px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.7);
}

.front { transform: rotateY(180deg); }
</style>
</head>

<body>

<div id="controls">
  <button onclick="deal('single')">Single Card</button>
  <button onclick="deal('three')">Past · Present · Future</button>
  <button onclick="deal('celtic')">Celtic Cross</button>
</div>

<div id="fan-container"></div>

<!-- sounds -->
<audio id="shuffleSound" src="sounds/shuffle.mp3" preload="auto"></audio>
<audio id="flipSound" src="sounds/flip.mp3" preload="auto"></audio>

<script>
const container = document.getElementById("fan-container");
const shuffleSound = document.getElementById("shuffleSound");
const flipSound = document.getElementById("flipSound");
const CARD_BACK = "cards/back.jpg";

/* ===== SHUFFLE ===== */
function shuffle(arr) {
  return [...arr].sort(() => Math.random() - 0.5);
}

/* ===== SPREAD POSITIONS ===== */

const spreads = {
  single: [
    { x: 400, y: 250 }
  ],

  three: [
    { x: 260, y: 250 },
    { x: 420, y: 250 },
    { x: 580, y: 250 }
  ],

  celtic: [
    { x: 360, y: 250 }, // 1 center
    { x: 360, y: 250, cross:true }, // 2 crossing
    { x: 360, y: 90  }, // 3 above
    { x: 360, y: 410 }, // 4 below
    { x: 200, y: 250 }, // 5 left
    { x: 520, y: 250 }, // 6 right
    { x: 700, y: 430 }, // 7
    { x: 700, y: 320 }, // 8
    { x: 700, y: 210 }, // 9
    { x: 700, y: 100 }  // 10
  ]
};

/* ===== DEAL ===== */

function deal(type) {
  container.innerHTML = "";
  shuffleSound.currentTime = 0;
  shuffleSound.play();

  const positions = spreads[type];
  const cards = shuffle(deck);

  positions.forEach((pos, i) => {
    const card = document.createElement("div");
    card.className = "card";
    card.style.left = pos.x + "px";
    card.style.top = pos.y + "px";
    card.style.zIndex = i + 1;

    if (pos.cross) card.style.transform = "rotate(90deg)";

    const inner = document.createElement("div");
    inner.className = "card-inner";

    const back = document.createElement("div");
    back.className = "face";
    back.style.backgroundImage = `url(${CARD_BACK})`;

    const front = document.createElement("div");
    front.className = "face front";
    front.style.backgroundImage = `url(${cards[i].img})`;

    card.addEventListener("click", () => {
      if (!card.classList.contains("flipped")) {
        flipSound.currentTime = 0;
        flipSound.play();
        card.classList.add("flipped");
      }
    });

    inner.append(back, front);
    card.appendChild(inner);
    container.appendChild(card);
  });
}

/* ===== FULL 78 CARD DECK ===== */

const deck = [
  ...Array.from({length:22},(_,i)=>({
    img:`cards/major/${String(i).padStart(2,"0")}_${[
      "Fool","Magician","High_Priestess","Empress","Emperor","Hierophant",
      "Lovers","Chariot","Strength","Hermit","Wheel","Justice","Hanged_Man",
      "Death","Temperance","Devil","Tower","Star","Moon","Sun","Judgement","World"
    ][i]}.jpg`
  })),
  ...["cups","wands","swords","pentacles"].flatMap(suit =>
    Array.from({length:14},(_,i)=>({
      img:`cards/${suit}/${suit}${String(i+1).padStart(2,"0")}.jpg`
    }))
  )
];
</script>

</body>
</html>
